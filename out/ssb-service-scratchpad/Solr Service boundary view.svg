<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2087px" preserveAspectRatio="none" style="width:1282px;height:2087px;" version="1.1" viewBox="0 0 1282 2087" width="1282px" zoomAndPan="magnify"><defs><filter height="300%" id="f5pdiwcufkxm0" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="230" x="519.5" y="17.4023">Solr Service boundary view</text><!--MD5=[aa2f05b2676d7d34ffa7e771fb7634f3]
cluster client--><rect fill="#FFFFFF" height="560" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="224" x="591" y="28.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="679.5" y="45.668">Client</text><!--MD5=[dd6272bc7b82fe3b135ddbc083aa29bc]
cluster aws_west--><rect fill="#FFFFFF" height="856.5" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="913" x="7" y="1072.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="399" y="1089.668">AWS us-west-2</text><!--MD5=[03deb33551299d7b80d4370a01a89112]
cluster iaas--><rect fill="#FFFFFF" height="787.5" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="865" x="31" y="1117.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193" x="367" y="1134.668">SSB managed boundary</text><!--MD5=[eba3611533c2073beb67baeaa4f63147]
cluster eks--><rect fill="#FFFFFF" height="718.5" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="817" x="55" y="1162.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="380.5" y="1179.668">EKS service instance</text><!--MD5=[b0de7715254a030710bcf109a057d164]
cluster k8s_ingress--><rect fill="#FFFFFF" height="125" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="288" x="198" y="1207.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="252" y="1224.668">k8s ingress controller</text><!--MD5=[b526a272651d63b4ba4398fb1561ad60]
cluster b_solrcloud--><rect fill="#FFFFFF" height="379" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="753" x="87" y="1469.6992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="153" x="387" y="1487.168">SolrCloud instance</text><!--MD5=[e2373e393a1be726fcf9eb7afb9b7efa]
cluster aws_govcloud--><rect fill="#FFFFFF" height="981.5" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="332" x="944" y="418.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="1050.5" y="435.668">AWS GovCloud</text><!--MD5=[1882a77a351c382316da64f5bec32f3f]
cluster cloudgov--><rect fill="#FFFFFF" height="912.5" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="284" x="968" y="463.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="1070" y="480.668">cloud.gov</text><!--MD5=[bfe4f767bb11f22a1eaa0d90d17cf673]
cluster atob--><rect fill="#FFFFFF" height="523.5" style="stroke:#444444;stroke-width:1.0;stroke-dasharray:7.0,7.0;" width="236" x="992" y="828.1992"/><text fill="#444444" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="1006" y="845.668">SSB application boundary</text><!--MD5=[8a719cf39157e20d2641a32c9871f429]
entity client_team--><rect fill="#08427B" height="86.8438" style="stroke:#073B6F;stroke-width:1.5;" width="117" x="607.5" y="65.1992"/><image height="48" width="48" x="642" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAIAAADYYG7QAAACD0lEQVR4Xu2YoU4EMRCGT+4j8Ai8AhaH4QHgAUjQuFMECUgMIUgwJAgMhgQsAYUiJCiQIBBY+EITsjfTdme6V24v4c8vyGbb+ZjOtN0bNcvjQXmkH83WvYBWto6PLm6v7p7uH1/w2fXD+PBycX1Pv2l3IdDm/vn7x+dXQiAubRzoURa7gRZWd0iGRIiJbOnhnfYBQZNJjNbuyY2eJG8fkDE3bbG4ep6MHUAsgYxmE3nVs6VsBWJSGccsOlFPmLIViMzLOB7pCVO2AtHJMohH7Fh6zqitQK7m0rJvAVYgGcEpe//PLdDz65sM4pF9N7ICcXDKIB5Nv6j7tD0NoSdM2QrU9Gg0ewE1LqBhHR3BBdvj2vapnidjHxD/q6vd7Pvhr31AwcY8eXMTXAKECZZJFXuEq27aLgQK5uLMohCenGGuGewOxSjBvYBqeG6B+Nqiblggdjnc+ZXDy+FNFpFzw76O3UBAROuXh6FoiAcf5g9eTvUgzy0nWg6I8cXHRUpg5bOVBCo+KDpFajOf23GgPme7RSQ+lacIENUgJ6gg1k6HjgOlqnLqip4tEuhv0hNEMXUD0clyXE3p6pZA0S2nnvTlXwLJEZWlb7cTQH1+USgTN4VhAenm/wea1OCAOmqo6fE1WCb9WSKBah+rbUWPWAmE2Rvk0ApiB45eOyNAzU8xcTvj8KvkKEoOaIYeHNA3ZuygAvFMUO0AAAAASUVORK5CYII=" y="75.1992"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="617.5" y="138.668">Client Team</text><!--MD5=[15d099bd719a512665c367382b0908f5]
entity osbapi_client--><rect fill="#999999" height="71.8203" style="stroke:#8A8A8A;stroke-width:1.5;" width="168" x="615" y="256.1992"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="643.5" y="281.668">OSBAPI Client</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="701" y="298.5781"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="144" x="629" y="315.0664">Service orchestration</text><!--MD5=[28086182ac95c60572e8f48101c7bfde]
entity solr_client--><rect fill="#999999" height="71.8203" style="stroke:#8A8A8A;stroke-width:1.5;" width="192" x="607" y="500.1992"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="661.5" y="525.668">Solr Client</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="705" y="542.5781"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="168" x="621" y="559.0664">Use provisioned services</text><!--MD5=[ec1d7b2963221ec44547f9db57a0c817]
entity solr_operator--><rect fill="#999999" height="88.3086" style="stroke:#8A8A8A;stroke-width:1.5;" width="216" x="624" y="1236.1992"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="678" y="1261.668">Solr Operator</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="734" y="1278.5781"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="188" x="638" y="1295.0664">manages custom SolrCloud</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="698.5" y="1311.5547">resources</text><!--MD5=[4123e6fc011c5f21e309f00172a09dfd]
entity solr_ingress--><rect fill="#1168BD" height="71.8203" style="stroke:#3C7FC0;stroke-width:1.5;" width="256" x="214" y="1244.1992"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="236" x="224" y="1269.668">&lt;instance&gt;.solr.ssb.data.gov</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="344" y="1286.5781"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="305" y="1303.0664">k8s ingress</text><!--MD5=[d72f9175236150b2c6829a9360b9f1a4]
entity solr_instances--><path d="M208,1524.6992 C208,1514.6992 311,1514.6992 311,1514.6992 C311,1514.6992 414,1514.6992 414,1524.6992 L414,1616.1406 C414,1626.1406 311,1626.1406 311,1626.1406 C311,1626.1406 208,1626.1406 208,1616.1406 L208,1524.6992 " fill="#438DD5" style="stroke:#3C7FC0;stroke-width:1.5;"/><path d="M208,1524.6992 C208,1534.6992 311,1534.6992 311,1534.6992 C311,1534.6992 414,1534.6992 414,1524.6992 " fill="none" style="stroke:#3C7FC0;stroke-width:1.5;"/><path d="M246.1667,1542.8763 L246.1667,1548.2096 L251.5,1548.2096 L251.5,1542.8763 L246.1667,1542.8763 M252.8333,1545.543 L252.8333,1549.543 L248.8333,1549.543 L248.8333,1550.8763 L254.1667,1550.8763 L254.1667,1545.543 L252.8333,1545.543 M255.5,1548.2096 L255.5,1552.2096 L251.5,1552.2096 L251.5,1553.543 L256.8333,1553.543 L256.8333,1548.2096 L255.5,1548.2096 " fill="#FFFFFF" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="262.8333" y="1554.168">Solr instances</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="76" x="273" y="1569.1445">[Apache Solr]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="313" y="1585.2109"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="168" x="227" y="1601.6992">open-source distributed</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="186" x="218" y="1618.1875">enterprise-search platform</text><!--MD5=[7146589bdf06a6b4aca59cb871dba27f]
entity zookeeper_instances--><path d="M111,1739.6992 C111,1729.6992 218,1729.6992 218,1729.6992 C218,1729.6992 325,1729.6992 325,1739.6992 L325,1814.6523 C325,1824.6523 218,1824.6523 218,1824.6523 C218,1824.6523 111,1824.6523 111,1814.6523 L111,1739.6992 " fill="#438DD5" style="stroke:#3C7FC0;stroke-width:1.5;"/><path d="M111,1739.6992 C111,1749.6992 218,1749.6992 218,1749.6992 C218,1749.6992 325,1749.6992 325,1739.6992 " fill="none" style="stroke:#3C7FC0;stroke-width:1.5;"/><path d="M125.6667,1757.8763 L125.6667,1763.2096 L131,1763.2096 L131,1757.8763 L125.6667,1757.8763 M132.3333,1760.543 L132.3333,1764.543 L128.3333,1764.543 L128.3333,1765.8763 L133.6667,1765.8763 L133.6667,1760.543 L132.3333,1760.543 M135,1763.2096 L135,1767.2096 L131,1767.2096 L131,1768.543 L136.3333,1768.543 L136.3333,1763.2096 L135,1763.2096 " fill="#FFFFFF" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="169" x="142.3333" y="1769.168">ZooKeeper instances</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="118" x="159" y="1784.1445">[Apache ZooKeeper]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="220" y="1800.2109"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="190" x="125" y="1816.6992">distributed cluster manager</text><!--MD5=[5305ec58f867991ed01797c9b1705e00]
entity aws_cg_alb--><rect fill="#999999" height="71.8203" style="stroke:#8A8A8A;stroke-width:1.5;" width="220" x="985" y="500.1992"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="200" x="995" y="525.668">cloud.gov load-balancer</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="1097" y="542.5781"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="1067.5" y="559.0664">AWS ALB</text><!--MD5=[520c8806735a893833bdb4d742b17895]
entity cloudgov_router--><rect fill="#999999" height="88.3086" style="stroke:#8A8A8A;stroke-width:1.5;" width="181.6667" x="1005" y="664.1992"/><path d="M1016,678.3763 L1016,683.7096 L1021.3333,683.7096 L1021.3333,678.3763 L1016,678.3763 M1022.6667,681.043 L1022.6667,685.043 L1018.6667,685.043 L1018.6667,686.3763 L1024,686.3763 L1024,681.043 L1022.6667,681.043 M1025.3333,683.7096 L1025.3333,687.7096 L1021.3333,687.7096 L1021.3333,689.043 L1026.6667,689.043 L1026.6667,683.7096 L1025.3333,683.7096 " fill="#FFFFFF" style="stroke:;stroke-width:0.0;stroke-dasharray:;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="144" x="1032.6667" y="689.668">cloud.gov routers</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="1097.8333" y="706.5781"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146" x="1022.8333" y="723.0664">Cloud Foundry traffic</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="1072.3333" y="739.5547">service</text><!--MD5=[ff23ef213edd9ee0f740d6cbc6ede895]
entity solr_app--><rect fill="#438DD5" height="116.5742" style="stroke:#3C7FC0;stroke-width:1.5;" width="195" x="1008.5" y="865.1992"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="1061" y="890.668">Solr broker</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="171" x="1018.5" y="905.6445">[Open Service Broker API, Go,</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="101" x="1055.5" y="919.7773">Terraform, Helm]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="1108" y="935.8438"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="155" x="1028.5" y="952.332">Brokers SolrCloud as a</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="158" x="1027" y="968.8203">service for applications</text><!--MD5=[7295f9b7678547b5f0ffeeef33e9abb0]
entity solr_app_db--><path d="M1008,1234.6992 C1008,1224.6992 1110,1224.6992 1110,1224.6992 C1110,1224.6992 1212,1224.6992 1212,1234.6992 L1212,1326.1406 C1212,1336.1406 1110,1336.1406 1110,1336.1406 C1110,1336.1406 1008,1336.1406 1008,1326.1406 L1008,1234.6992 " fill="#438DD5" style="stroke:#3C7FC0;stroke-width:1.5;"/><path d="M1008,1234.6992 C1008,1244.6992 1110,1244.6992 1110,1244.6992 C1110,1244.6992 1212,1244.6992 1212,1234.6992 " fill="none" style="stroke:#3C7FC0;stroke-width:1.5;"/><text fill="#FFFFFF" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97" x="1061.5" y="1264.168">Broker State</text><text fill="#FFFFFF" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="45" x="1087.5" y="1279.1445">[MySQL]</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="1112" y="1295.2109"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="176" x="1022" y="1311.6992">Store state of provisioned</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1076.5" y="1328.1875">resources</text><path d="M359.5,80.6992 L359.5,136.6309 L572.5,136.6309 L572.5,90.6992 L562.5,80.6992 L359.5,80.6992 " fill="#FBFB77" filter="url(#f5pdiwcufkxm0)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M562.5,80.6992 L562.5,90.6992 L572.5,90.6992 L562.5,80.6992 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="365.5" y="98.2676">All connections depicted are</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="365.5" y="113.5781">encrypted with TLS 1.2 unless</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="365.5" y="128.8887">otherwise noted.</text><!--MD5=[b3bd77e232900fec002ae8b4691c767c]
link osbapi_client to solr_client--><path d="M699.58,328.3892 C700.3,371.6692 701.51,445.1392 702.28,491.8492 " fill="none" id="osbapi_client-to-solr_client" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="702.42,499.9692,705.2764,491.9168,699.2774,492.0242,702.42,499.9692" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="701" y="370.8008">provide service</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="716" y="384.9336">credentials</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="28" x="736" y="399.0664">[any]</text><!--MD5=[0a1a1d75500637dbc8f2e8dd94e5dc5a]
link client_team to osbapi_client--><path d="M673.74,152.2492 C678.98,181.0792 685.88,219.0492 691.15,248.0092 " fill="none" id="client_team-to-osbapi_client" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="692.59,255.9192,694.1132,247.5121,688.2096,248.5835,692.59,255.9192" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="687" y="194.8008">request service instance</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="710.5" y="208.9336">for service client</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="28" x="748" y="223.0664">[any]</text><!--MD5=[a57739a3103e4fa986b4616a684e8592]
link osbapi_client to aws_cg_alb--><path d="M758.21,328.2892 C774.39,337.9392 791.89,348.4292 808,358.1992 C885.32,405.0892 973.82,459.8392 1031.86,495.8892 " fill="none" id="osbapi_client-to-aws_cg_alb" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="1038.79,500.1892,1033.5704,493.4249,1030.4097,498.5249,1038.79,500.1892" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="88" x="902.5" y="370.8008">broker service</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="890.5" y="384.9336">instances (OSBAPI)</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="137" x="880" y="399.0664">[https GET/POST (443)]</text><!--MD5=[4ce174d1a9e01dc3e10890565860666d]
link aws_cg_alb to cloudgov_router--><path d="M1095.21,572.4192 C1095.35,596.5692 1095.54,628.9992 1095.7,655.9892 " fill="none" id="aws_cg_alb-to-cloudgov_router" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="1095.75,664.1792,1098.7071,656.1633,1092.7072,656.1954,1095.75,664.1792" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="1112.5" y="616.8008">proxies requests</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="137" x="1096" y="630.9336">[https GET/POST (443)]</text><!--MD5=[e17fa57e05d4a3cf68e9f40ad93fdbeb]
link cloudgov_router to solr_app--><path d="M1098.02,752.3992 C1099.43,782.4092 1101.33,822.9492 1102.92,856.9392 " fill="none" id="cloudgov_router-to-solr_app" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="1103.3,864.9892,1105.9106,856.8538,1099.9175,857.1433,1103.3,864.9892" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="1117.5" y="794.8008">proxies requests</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="137" x="1101" y="808.9336">[https GET/POST (443)]</text><!--MD5=[34f7ed07991caf7103df9d71d6c0d461]
link solr_app to solr_app_db--><path d="M1106.65,982.4492 C1107.38,1046.6992 1108.54,1150.1692 1109.29,1216.3892 " fill="none" id="solr_app-to-solr_app_db" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="1109.38,1224.6792,1112.2941,1216.6475,1106.2945,1216.7118,1109.38,1224.6792" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="125" x="1108" y="1031.8008">store and read state</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="76" x="1132.5" y="1045.9336">[port (3306)]</text><!--MD5=[922ce7184c32a4e3c5df040627ff3315]
link solr_client to solr_ingress--><path d="M685.83,572.4892 C626.08,695.3092 427.34,1103.7792 362.59,1236.8792 " fill="none" id="solr_client-to-solr_ingress" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="359.06,1244.1292,365.2602,1238.2507,359.8661,1235.6233,359.06,1244.1292" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="143" x="581" y="794.8008">use SolrCloud instance</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="145" x="580" y="808.9336">[https GET/POST (8193)]</text><!--MD5=[2788139f3a946ae0c5351a1b315ff09e]
link solr_instances to solr_instances--><path d="M414.21,1551.1792 C434.54,1553.3492 449,1559.6892 449,1570.1992 C449,1579.2292 438.32,1585.1792 422.42,1588.0592 " fill="none" id="solr_instances-to-solr_instances" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="414.21,1589.2192,422.5534,1591.0598,421.7064,1585.1199,414.21,1589.2192" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="469" y="1560.8008">shards and routes</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="504.5" y="1574.9336">queries</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="145" x="455" y="1589.0664">[https GET/POST (8193)]</text><!--MD5=[db041af4f7bc2e503a397d663ad8d453]
link solr_instances to zookeeper_instances--><path d="M286.2,1625.8692 C272.66,1655.7192 255.95,1692.5492 242.46,1722.2792 " fill="none" id="solr_instances-to-zookeeper_instances" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="239.11,1729.6792,245.1533,1723.6395,239.6918,1721.155,239.11,1729.6792" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="281.5" y="1668.3008">delegates cluster</text><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="296" y="1682.4336">management</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="131" x="271" y="1696.5664">[port 2181 plain text?]</text><!--MD5=[7cb1e35c3c5d69a1a42141152e1e67c8]
link zookeeper_instances to zookeeper_instances--><path d="M325.13,1771.3692 C345.56,1772.0692 360,1774.0092 360,1777.1992 C360,1779.9392 349.33,1781.7592 333.37,1782.6592 " fill="none" id="zookeeper_instances-to-zookeeper_instances" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="325.13,1783.0292,333.256,1785.6688,332.988,1779.6748,325.13,1783.0292" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="130" x="366.5" y="1774.8008">cluster configuration</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="131" x="366" y="1788.9336">[port 2181 plain text?]</text><!--MD5=[7cb1e35c3c5d69a1a42141152e1e67c8]
link zookeeper_instances to zookeeper_instances--><path d="M325.07,1766.0292 C407.97,1762.8892 503,1766.6092 503,1777.1992 C503,1787.4392 414.18,1791.2592 333.37,1788.6592 " fill="none" id="zookeeper_instances-to-zookeeper_instances-1" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="325.07,1788.3692,332.9637,1791.6388,333.1671,1785.6422,325.07,1788.3692" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="518.5" y="1774.8008">cluster replication</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="131" x="509" y="1788.9336">[port 2888 plain text?]</text><!--MD5=[7cb1e35c3c5d69a1a42141152e1e67c8]
link zookeeper_instances to zookeeper_instances--><path d="M325.01,1762.7292 C455.33,1754.4792 646,1759.2992 646,1777.1992 C646,1794.7292 463.07,1799.7192 333.1,1792.1592 " fill="none" id="zookeeper_instances-to-zookeeper_instances-2" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="325.01,1791.6692,332.8131,1795.1494,333.1774,1789.1604,325.01,1791.6692" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="672" y="1774.8008">leader election</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="131" x="652" y="1788.9336">[port 3888 plain text?]</text><!--MD5=[4191b627cee599cec42d1b826592fdc4]
link solr_app to solr_operator--><path d="M1008.13,980.6892 C993.5,990.5092 978.99,1001.1492 966,1012.1992 C887.34,1079.1092 811.41,1172.7992 768.33,1229.5592 " fill="none" id="solr_app-to-solr_operator" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="763.5,1235.9592,770.7115,1231.3772,765.9205,1227.7652,763.5,1235.9592" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="967" y="1024.8008">provisions SolrCloud</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="99" x="981" y="1038.9336">[Terraform (helm</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="57" x="1004" y="1053.0664">provider)]</text><!--MD5=[aed29af938178f2a48bb6b411c7aaeb6]
link solr_operator to b_solrcloud--><path d="M761.68,1324.3892 C783.09,1358.0092 810.51,1406.7192 824,1453.6992 C824.8738,1456.7423 825.6703,1459.8482 826.3958,1462.9976 C826.7585,1464.5722 827.1035,1466.1578 827.4315,1467.7518 C827.5135,1468.1503 827.5944,1468.5493 827.6743,1468.9489 C827.7143,1469.1486 827.754,1469.3485 827.7934,1469.5485 " fill="none" id="solr_operator-to-b_solrcloud" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="827.7934,1469.5485,829.1897,1461.1194,823.3029,1462.2797,827.7934,1469.5485" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="856.5" y="1428.3008">provisions</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="137" x="821" y="1442.4336">[https GET/POST (443)]</text><!--MD5=[f09f7063483689ae6d459c7add86f513]
link solr_ingress to solr_instances--><path d="M284.15,1316.4192 C251.33,1339.9792 213.27,1374.2292 195,1415.6992 C180.23,1449.2292 199.42,1482.2092 226.17,1508.9592 " fill="none" id="solr_ingress-to-solr_instances" style="stroke:#666666;stroke-width:1.0;"/><polygon fill="#666666" points="231.99,1514.5692,228.3076,1506.8595,224.1462,1511.1818,231.99,1514.5692" style="stroke:#666666;stroke-width:1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="104" x="213.5" y="1428.3008">proxies requests</text><text fill="#666666" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="139" x="196" y="1442.4336">[http GET/POST (8193)]</text><rect fill="#FFFFFF" height="129.418" rx="5" ry="5" style="stroke:#FFFFFF;stroke-width:1.0;" width="146" x="1114" y="1941.6992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="51" x="1120" y="1962.2344">Legend</text><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="1175" y="1962.2344"/><rect fill="#08427B" height="16.4883" style="stroke:none;stroke-width:1.0;" width="134" x="1120" y="1965.1875"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="1124" y="1978.7227">person</text><rect fill="#1168BD" height="16.4883" style="stroke:none;stroke-width:1.0;" width="134" x="1120" y="1981.6758"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="47" x="1124" y="1995.2109">system</text><rect fill="#438DD5" height="16.4883" style="stroke:none;stroke-width:1.0;" width="134" x="1120" y="1998.1641"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="1124" y="2011.6992">container</text><rect fill="#686868" height="16.4883" style="stroke:none;stroke-width:1.0;" width="134" x="1120" y="2014.6523"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="1124" y="2028.1875">external person</text><rect fill="#999999" height="16.4883" style="stroke:none;stroke-width:1.0;" width="134" x="1120" y="2031.1406"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="108" x="1124" y="2044.6758">external system</text><rect fill="#B3B3B3" height="16.4883" style="stroke:none;stroke-width:1.0;" width="134" x="1120" y="2047.6289"/><text fill="#FFFFFF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="1124" y="2061.1641">external container</text><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="1948.6992" y2="1948.6992"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="1965.1875" y2="1965.1875"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="1981.6758" y2="1981.6758"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="1998.1641" y2="1998.1641"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="2014.6523" y2="2014.6523"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="2031.1406" y2="2031.1406"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="2047.6289" y2="2047.6289"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1254" y1="2064.1172" y2="2064.1172"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1120" x2="1120" y1="1948.6992" y2="2064.1172"/><line style="stroke:#FFFFFF;stroke-width:1.0;" x1="1254" x2="1254" y1="1948.6992" y2="2064.1172"/><!--MD5=[89c2b53a4a2b7c8ab6f3302deb1a3de3]
@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml
' uncomment the following line and comment the first to use locally
' !include C4_Container.puml
LAYOUT_WITH_LEGEND()
title Solr Service boundary view
Boundary(client, "Client") {
  Person(client_team, "Client Team")
  System_Ext(osbapi_client, "OSBAPI Client", "Service orchestration")
  System_Ext(solr_client, "Solr Client", "Use provisioned services")
  Rel(osbapi_client, solr_client, "provide service credentials", "any")
  Rel(client_team, osbapi_client, "request service instance for service client", "any")
}
note as EncryptionNote
  All connections depicted are encrypted with TLS 1.2 unless otherwise noted.
end note

Boundary(aws_west, "AWS us-west-2") {
  Boundary(iaas, "SSB managed boundary") {
    Boundary(eks, "EKS service instance") {
      System_Ext(solr_operator, "Solr Operator", "manages custom SolrCloud resources")
      Boundary(k8s_ingress, "k8s ingress controller") {    
        System(solr_ingress, "<instance>.solr.ssb.data.gov", "k8s ingress")
      }
      Boundary(b_solrcloud, "SolrCloud instance") {
        ContainerDb(solr_instances, "<&layers> Solr instances", "Apache Solr", "open-source distributed enterprise-search platform")
        ContainerDb(zookeeper_instances, "<&layers> ZooKeeper instances", "Apache ZooKeeper", "distributed cluster manager")
      }
    }
  }
}
Boundary(aws_govcloud, "AWS GovCloud") {
  Boundary(cloudgov, "cloud.gov") {
    System_Ext(aws_cg_alb, "cloud.gov load-balancer", "AWS ALB")
    System_Ext(cloudgov_router, "<&layers> cloud.gov routers", "Cloud Foundry traffic service")
    Boundary(atob, "SSB application boundary") {
      Container(solr_app, "Solr broker", "Open Service Broker API, Go, Terraform, Helm", "Brokers SolrCloud as a service for applications")
      ContainerDb(solr_app_db, "Broker State", "MySQL", "Store state of provisioned resources")
    }
  }
}
Rel(osbapi_client, aws_cg_alb, "broker service instances (OSBAPI)", "https GET/POST (443)")
Rel(aws_cg_alb, cloudgov_router, "proxies requests", "https GET/POST (443)")
Rel(cloudgov_router, solr_app, "proxies requests", "https GET/POST (443)")
Rel(solr_app, solr_app_db, "store and read state", "port (3306)")
Rel(solr_client, solr_ingress, "use SolrCloud instance", "https GET/POST (8193)")
Rel(solr_instances, solr_instances, "shards and routes queries", "https GET/POST (8193)")
Rel(solr_instances, zookeeper_instances, "delegates cluster management", "port 2181 plain text?")
Rel(zookeeper_instances, zookeeper_instances, "cluster configuration", "port 2181 plain text?")
Rel(zookeeper_instances, zookeeper_instances, "cluster replication", "port 2888 plain text?")
Rel(zookeeper_instances, zookeeper_instances, "leader election", "port 3888 plain text?")
Rel(solr_app, solr_operator, "provisions SolrCloud", "Terraform (helm provider)")
Rel(solr_operator, b_solrcloud, "provisions", "https GET/POST (443)")
Rel(solr_ingress, solr_instances, "proxies requests", "http GET/POST (8193)")
@enduml

@startuml








skinparam defaultTextAlignment center

skinparam wrapWidth 200
skinparam maxMessageSize 150

skinparam LegendBorderColor transparent
skinparam LegendBackgroundColor transparent
skinparam LegendFontColor #FFFFFF

skinparam rectangle {
    StereotypeFontSize 12
    shadowing false
}

skinparam database {
    StereotypeFontSize 12
    shadowing false
}

skinparam queue {
    StereotypeFontSize 12
    shadowing false
}

skinparam Arrow {
    Color #666666
    FontColor #666666
    FontSize 12
}

skinparam package {
    StereotypeFontSize 6
    StereotypeFontColor #FFFFFF
    FontStyle plain
    BackgroundColor #FFFFFF
}

skinparam rectangle<<boundary>> {
    Shadowing false
    StereotypeFontSize 6
    StereotypeFontColor #FFFFFF
    FontColor #444444
    BorderColor #444444
    BackgroundColor #FFFFFF
    BorderStyle dashed
}



















































skinparam rectangle<<person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #08427B
    BorderColor #073B6F
}
skinparam database<<person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #08427B
    BorderColor #073B6F
}
skinparam queue<<person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #08427B
    BorderColor #073B6F
}

skinparam rectangle<<external_person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #686868
    BorderColor #8A8A8A
}
skinparam database<<external_person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #686868
    BorderColor #8A8A8A
}
skinparam queue<<external_person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #686868
    BorderColor #8A8A8A
}

skinparam rectangle<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}
skinparam database<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}
skinparam queue<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam rectangle<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}
skinparam database<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}
skinparam queue<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}




sprite $person [48x48/16] {
000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000
0000000000000000000049BCCA7200000000000000000000
0000000000000000006EFFFFFFFFB3000000000000000000
00000000000000001CFFFFFFFFFFFF700000000000000000
0000000000000001EFFFFFFFFFFFFFF80000000000000000
000000000000000CFFFFFFFFFFFFFFFF6000000000000000
000000000000007FFFFFFFFFFFFFFFFFF100000000000000
00000000000001FFFFFFFFFFFFFFFFFFF900000000000000
00000000000006FFFFFFFFFFFFFFFFFFFF00000000000000
0000000000000BFFFFFFFFFFFFFFFFFFFF40000000000000
0000000000000EFFFFFFFFFFFFFFFFFFFF70000000000000
0000000000000FFFFFFFFFFFFFFFFFFFFF80000000000000
0000000000000FFFFFFFFFFFFFFFFFFFFF80000000000000
0000000000000DFFFFFFFFFFFFFFFFFFFF60000000000000
0000000000000AFFFFFFFFFFFFFFFFFFFF40000000000000
00000000000006FFFFFFFFFFFFFFFFFFFE00000000000000
00000000000000EFFFFFFFFFFFFFFFFFF800000000000000
000000000000007FFFFFFFFFFFFFFFFFF100000000000000
000000000000000BFFFFFFFFFFFFFFFF5000000000000000
0000000000000001DFFFFFFFFFFFFFF70000000000000000
00000000000000000BFFFFFFFFFFFF500000000000000000
0000000000000000005DFFFFFFFFA1000000000000000000
0000000000000000000037ABB96100000000000000000000
000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000
000000000000025788300000000005886410000000000000
000000000007DFFFFFFD9643347BFFFFFFFB400000000000
0000000004EFFFFFFFFFFFFFFFFFFFFFFFFFFB1000000000
000000007FFFFFFFFFFFFFFFFFFFFFFFFFFFFFD200000000
00000006FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE10000000
0000003FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB0000000
000000BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5000000
000003FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD000000
000009FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF200000
00000DFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF600000
00000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF800000
00001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA00000
00001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB00000
00001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB00000
00001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB00000
00001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA00000
00000EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF700000
000006FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE100000
0000008FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD3000000
000000014555555555555555555555555555555300000000
000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000
}

sprite $person2 [48x48/16] {
0000000000000000000049BCCA7200000000000000000000
0000000000000000006EFFFFFFFFB3000000000000000000
00000000000000001CFFFFFFFFFFFF700000000000000000
0000000000000001EFFFFFFFFFFFFFF80000000000000000
000000000000000CFFFFFFFFFFFFFFFF6000000000000000
000000000000007FFFFFFFFFFFFFFFFFF100000000000000
00000000000001FFFFFFFFFFFFFFFFFFF900000000000000
00000000000006FFFFFFFFFFFFFFFFFFFF00000000000000
0000000000000BFFFFFFFFFFFFFFFFFFFF40000000000000
0000000000000EFFFFFFFFFFFFFFFFFFFF70000000000000
0000000000000FFFFFFFFFFFFFFFFFFFFF80000000000000
0000000000000FFFFFFFFFFFFFFFFFFFFF80000000000000
0000000000000DFFFFFFFFFFFFFFFFFFFF60000000000000
0000000000000AFFFFFFFFFFFFFFFFFFFF40000000000000
00000000000006FFFFFFFFFFFFFFFFFFFE00000000000000
00000000000000EFFFFFFFFFFFFFFFFFF800000000000000
000000000000007FFFFFFFFFFFFFFFFFF100000000000000
000000000000000BFFFFFFFFFFFFFFFF5000000000000000
0000000000000001DFFFFFFFFFFFFFF70000000000000000
00000000000000000BFFFFFFFFFFFF500000000000000000
0000000000000000005DFFFFFFFFA1000000000000000000
0000000000000000000037ABB96100000000000000000000
000000000002578888300000000005888864100000000000
0000000007DFFFFFFFFD9643347BFFFFFFFFFB4000000000
00000004EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB10000000
0000007FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD2000000
000006FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE100000
00003FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB00000
0000BFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF50000
0003FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD0000
0009FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF2000
000DFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6000
000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8000
001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB000
001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB000
001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB000
001FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA000
000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8000
000DFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6000
0009FFFFFFFF8FFFFFFFFFFFFFFFFFFFFFF8FFFFFFFF2000
0003FFFFFFFF8FFFFFFFFFFFFFFFFFFFFFF8FFFFFFFD0000
0000BFFFFFFF8FFFFFFFFFFFFFFFFFFFFFF8FFFFFFF50000
00003FFFFFFF8FFFFFFFFFFFFFFFFFFFFFF8FFFFFFB00000
000006FFFFFF8FFFFFFFFFFFFFFFFFFFFFF8FFFFFE100000
0000007FFFFF8FFFFFFFFFFFFFFFFFFFFFF8FFFFD2000000
00000004EFFF8FFFFFFFFFFFFFFFFFFFFFF8FFFB10000000
0000000007DF8FFFFFFFFFFFFFFFFFFFFFF8FB4000000000
000000000002578888888888888888888864100000000000
}























skinparam rectangle<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}
skinparam database<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}
skinparam queue<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}

skinparam rectangle<<external_container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #B3B3B3
    BorderColor #A6A6A6
}
skinparam database<<external_container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #B3B3B3
    BorderColor #A6A6A6
}
skinparam queue<<external_container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #B3B3B3
    BorderColor #A6A6A6
}














hide stereotype
legend right
|<color:#000000>**Legend**</color> |
|<#08427B> person |
|<#1168BD> system |
|<#438DD5> container |
|<#686868> external person |
|<#999999> external system |
|<#B3B3B3> external container |
endlegend
title Solr Service boundary view
rectangle "==Client" <<boundary>> as client {
  rectangle "<$person>\n==Client Team" <<person>> as client_team
  rectangle "==OSBAPI Client\n\n Service orchestration" <<external_system>> as osbapi_client
  rectangle "==Solr Client\n\n Use provisioned services" <<external_system>> as solr_client
osbapi_client - ->> solr_client : **provide service credentials**\n//<size:12>[any]</size>//
client_team - ->> osbapi_client : **request service instance for service client**\n//<size:12>[any]</size>//
}
note as EncryptionNote
  All connections depicted are encrypted with TLS 1.2 unless otherwise noted.
end note

rectangle "==AWS us-west-2" <<boundary>> as aws_west {
  rectangle "==SSB managed boundary" <<boundary>> as iaas {
    rectangle "==EKS service instance" <<boundary>> as eks {
      rectangle "==Solr Operator\n\n manages custom SolrCloud resources" <<external_system>> as solr_operator
      rectangle "==k8s ingress controller" <<boundary>> as k8s_ingress {    
        rectangle "==<instance>.solr.ssb.data.gov\n\n k8s ingress" <<system>> as solr_ingress
      }
      rectangle "==SolrCloud instance" <<boundary>> as b_solrcloud {
        database "==<&layers> Solr instances\n//<size:12>[Apache Solr]</size>//\n\n open-source distributed enterprise-search platform" <<container>> as solr_instances
        database "==<&layers> ZooKeeper instances\n//<size:12>[Apache ZooKeeper]</size>//\n\n distributed cluster manager" <<container>> as zookeeper_instances
      }
    }
  }
}
rectangle "==AWS GovCloud" <<boundary>> as aws_govcloud {
  rectangle "==cloud.gov" <<boundary>> as cloudgov {
    rectangle "==cloud.gov load-balancer\n\n AWS ALB" <<external_system>> as aws_cg_alb
    rectangle "==<&layers> cloud.gov routers\n\n Cloud Foundry traffic service" <<external_system>> as cloudgov_router
    rectangle "==SSB application boundary" <<boundary>> as atob {
      rectangle "==Solr broker\n//<size:12>[Open Service Broker API, Go, Terraform, Helm]</size>//\n\n Brokers SolrCloud as a service for applications" <<container>> as solr_app
      database "==Broker State\n//<size:12>[MySQL]</size>//\n\n Store state of provisioned resources" <<container>> as solr_app_db
    }
  }
}
osbapi_client - ->> aws_cg_alb : **broker service instances (OSBAPI)**\n//<size:12>[https GET/POST (443)]</size>//
aws_cg_alb - ->> cloudgov_router : **proxies requests**\n//<size:12>[https GET/POST (443)]</size>//
cloudgov_router - ->> solr_app : **proxies requests**\n//<size:12>[https GET/POST (443)]</size>//
solr_app - ->> solr_app_db : **store and read state**\n//<size:12>[port (3306)]</size>//
solr_client - ->> solr_ingress : **use SolrCloud instance**\n//<size:12>[https GET/POST (8193)]</size>//
solr_instances - ->> solr_instances : **shards and routes queries**\n//<size:12>[https GET/POST (8193)]</size>//
solr_instances - ->> zookeeper_instances : **delegates cluster management**\n//<size:12>[port 2181 plain text?]</size>//
zookeeper_instances - ->> zookeeper_instances : **cluster configuration**\n//<size:12>[port 2181 plain text?]</size>//
zookeeper_instances - ->> zookeeper_instances : **cluster replication**\n//<size:12>[port 2888 plain text?]</size>//
zookeeper_instances - ->> zookeeper_instances : **leader election**\n//<size:12>[port 3888 plain text?]</size>//
solr_app - ->> solr_operator : **provisions SolrCloud**\n//<size:12>[Terraform (helm provider)]</size>//
solr_operator - ->> b_solrcloud : **provisions**\n//<size:12>[https GET/POST (443)]</size>//
solr_ingress - ->> solr_instances : **proxies requests**\n//<size:12>[http GET/POST (8193)]</size>//
@enduml

PlantUML version 1.2020.22(Sun Dec 06 01:36:27 PST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>